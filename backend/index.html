<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Tester</title>

    <script>
        const fileToBase64 = async (file) => new Promise((resolve, reject) => {
            const reader = new FileReader()
            reader.readAsDataURL(file)
            reader.onload = () => resolve(reader.result.substr(reader.result.indexOf(',') + 1))
            reader.onerror = (e) => reject(e)
        });
        const upload_image = () => {
            var file = image_chooser.files[0];
            fileToBase64(file)
            .then((encoded) => {
                console.log(encoded);
                options = {
                    method:'post',
                    mode:'cors',
                    headers:{
                        'Content-Type':'application/json'
                    },
                    body:JSON.stringify({data:encoded})
                }
                fetch('http://127.0.0.1:3000/test', options)
                .then(response => response.json())
                .then((data) => {
                    console.log(data);
                })
            });
        }
        const sign_up = () => {
            options = {
                method:'post',
                mode:'cors',
                headers:{
                    'Content-Type':'application/json'
                },
                body:JSON.stringify({username:'zero', password:'testing123', fullname:'zerothechosen'})
            }
            fetch('http://127.0.0.1:3000/login', options)
            .then(response => response.json())
            .then((data) => {
                console.log(data);
            })
        }
        const verify_token = () => {
            options = {
                method:'post',
                mode:'cors',
                headers:{
                    'Content-Type':'application/json'
                },
                body:JSON.stringify({"token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Inplcm8iLCJpYXQiOjE2Njc1NjYyMDUsImV4cCI6MTY2NzU2NzIwNX0.eQUE8eg_1gqCVih2mnsxpPOv_hznUik3XTZmQyWu0gk"})
            }
            fetch('http://127.0.0.1:3000/token/verify', options)
            .then(response => response.json())
            .then((data) => {
                console.log(data);
            })
        }
    </script>

</head>
<body>
    <div id="output"></div>
    <button onclick="sign_up()">Login</button>
    <button onclick="verify_token()">Verify</button>
    <input id="image_chooser" type="file" accept="image/*"/>
</body>
</html>